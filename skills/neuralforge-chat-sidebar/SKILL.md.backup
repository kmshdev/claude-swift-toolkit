---
name: neuralforge-chat-sidebar
description: Use when building a SwiftUI AI chat/discussion sidebar panel with user and assistant message bubbles, avatar-aligned conversations, streaming 'thinking...' indicators, generated work item links, and a bottom message input bar. Covers ScrollView with anchored scrolling, message bubble views, markdown rendering in chat, typing indicators, real-time streaming text, contextual work item generation cards, and dark-themed inspector-panel chat layouts with Liquid Glass effects for macOS Tahoe and iOS 26.
---

# Neuralforge Chat Sidebar

A comprehensive SwiftUI reference for building AI-powered chat sidebar panels. Covers the full stack of components needed: inspector panel layout, message bubbles, scroll anchoring, streaming/typing indicators, text input bars, avatar identity, Liquid Glass effects, and generated work item cards.

All documentation is sourced from Apple's official SwiftUI documentation (via sosumi.ai extraction). Platform targets are macOS Tahoe (26) and iOS 26, with Liquid Glass as the primary design language.

## When to Use This Skill

Use this skill when:

- Building a **chat sidebar panel** in SwiftUI (inspector-style or NavigationSplitView trailing column)
- Implementing **message bubbles** with user/assistant alignment, rounded corners, and foreground styling
- Adding **scroll-to-bottom anchoring** for chat message lists that auto-scroll on new messages
- Creating **streaming text indicators** (typing dots, "thinking..." animations, phase-based animations)
- Building a **text input bar** pinned to the bottom of a chat view with submit handling and keyboard shortcuts
- Styling chat UI with **Liquid Glass effects** (macOS Tahoe / iOS 26)
- Displaying **avatar images** (Circle clips, AsyncImage for remote avatars, overlay badges)
- Creating **generated work item cards** with buttons, labels, badges, and tint colors
- Implementing **dark mode theming** with `preferredColorScheme` and adaptive colors

Do **not** use this skill for:
- Non-SwiftUI chat implementations (UIKit, AppKit directly)
- Server-side chat logic or networking
- General SwiftUI tutorials unrelated to chat/sidebar patterns

## Key Concepts

| Concept | SwiftUI Component | Reference File |
|---|---|---|
| Inspector panel layout | `NavigationSplitView`, `.inspector()`, `.safeAreaInset()` | `inspector_panel.md` |
| Message bubble shape | `RoundedRectangle`, `Capsule`, `.clipShape()`, `.background(_:in:)` | `message_bubble.md` |
| Message list scrolling | `ScrollView`, `.defaultScrollAnchor(.bottom)`, `ScrollViewReader` | `scrolling_and_anchoring.md` |
| Streaming/typing animation | `ProgressView`, `.phaseAnimator()`, `.contentTransition()`, `TimelineView` | `streaming_and_typing.md` |
| Text input bar | `TextField`, `.onSubmit()`, `@FocusState`, `.submitLabel()`, `.keyboardShortcut()` | `text_input.md` |
| Avatar display | `Circle`, `AsyncImage`, `Image`, `.overlay()`, `.clipShape(Circle())` | `avatar_and_identity.md` |
| Color and theming | `Color`, `.preferredColorScheme()`, `.foregroundStyle()` | `color_and_theming.md` |
| Liquid Glass effects | `.glassEffect()`, `GlassEffectContainer`, `GlassButtonStyle`, `.scrollEdgeEffectStyle()` | `liquid_glass.md` |
| Generated item cards | `Button`, `Label`, `.badge()`, `.tint()`, `.buttonStyle()`, `GlassButtonStyle` | `generated_items.md` |
| Layout primitives | `VStack`, `HStack`, `ZStack`, `LazyVStack`, `Spacer`, `Divider` | `message_list_layout.md` |
| Interactions | `.sensoryFeedback()`, `.onHover()`, `.disabled()`, `.onTapGesture()`, `.contextMenu()` | `button_and_interaction.md` |
| Sizing | `.frame(minWidth:idealWidth:maxWidth:...)` | `other.md` |

## Quick Reference

### Chat Message List with Bottom Anchoring

Auto-scroll to the latest message using `defaultScrollAnchor(.bottom)`:

```swift
ScrollView {
    LazyVStack(alignment: .leading, spacing: 12) {
        ForEach(messages) { message in
            MessageBubbleView(message: message)
        }
    }
}
.defaultScrollAnchor(.bottom)
```

### Programmatic Scroll-to-Bottom

Use `ScrollViewReader` to scroll on new message arrival:

```swift
@Namespace var bottomID

ScrollViewReader { proxy in
    ScrollView {
        LazyVStack {
            ForEach(messages) { msg in
                MessageBubbleView(message: msg)
            }
            Color.clear.frame(height: 1).id(bottomID)
        }
    }
    .onChange(of: messages.count) { _ in
        withAnimation {
            proxy.scrollTo(bottomID)
        }
    }
}
```

### Message Bubble with Rounded Background

User bubble aligned trailing, assistant bubble aligned leading:

```swift
HStack {
    if message.isUser { Spacer() }

    Text(message.content)
        .padding(12)
        .foregroundStyle(message.isUser ? .white : .primary)
        .background(
            message.isUser ? Color.blue : Color(.systemGray5),
            in: RoundedRectangle(cornerRadius: 16)
        )

    if !message.isUser { Spacer() }
}
.padding(.horizontal)
```

### Avatar with Circle Clip and Overlay

```swift
AsyncImage(url: avatarURL) { image in
    image.resizable()
} placeholder: {
    Circle()
        .fill(Color.gray.opacity(0.3))
}
.frame(width: 36, height: 36)
.clipShape(Circle())
.overlay(alignment: .bottomTrailing) {
    Circle()
        .fill(.green)
        .frame(width: 10, height: 10)
}
```

### Streaming Typing Indicator (Phase Animation)

Animate dots for a "thinking..." indicator:

```swift
HStack(spacing: 4) {
    ForEach(0..<3, id: \.self) { index in
        Circle()
            .frame(width: 8, height: 8)
            .foregroundStyle(.secondary)
            .phaseAnimator([false, true]) { content, phase in
                content.opacity(phase ? 1 : 0.3)
            } animation: { _ in
                .easeInOut(duration: 0.6)
                    .delay(Double(index) * 0.2)
            }
    }
}
```

### Indeterminate ProgressView as Typing Indicator

```swift
ProgressView()
    .progressViewStyle(.circular)
    .scaleEffect(0.8)
```

### Bottom Text Input Bar (safeAreaInset)

Pin an input bar to the bottom of the chat scroll:

```swift
ScrollView {
    // message list content
}
.safeAreaInset(edge: .bottom) {
    HStack {
        TextField("Message...", text: $messageText, axis: .vertical)
            .lineLimit(1...4)
            .textFieldStyle(.roundedBorder)
            .focused($isInputFocused)
            .onSubmit { sendMessage() }
            .submitLabel(.send)

        Button("Send", systemImage: "arrow.up.circle.fill") {
            sendMessage()
        }
        .disabled(messageText.isEmpty)
        .keyboardShortcut(.return, modifiers: .command)
    }
    .padding()
}
```

### Inspector-Style Sidebar Panel

Present the chat as an inspector trailing column:

```swift
MyEditorView()
    .inspector(isPresented: $showChat) {
        ChatView()
            .inspectorColumnWidth(min: 280, ideal: 320, max: 400)
    }
```

### Liquid Glass Button (iOS 26+ / macOS Tahoe)

```swift
Button("Generate Task", systemImage: "sparkles") {
    generateWorkItem()
}
.buttonStyle(.glass)
```

### Liquid Glass Effect on Custom View

```swift
GlassEffectContainer {
    HStack {
        Label("AI Response", systemImage: "brain")
            .padding()
            .glassEffect()
    }
}
```

### Scroll Edge Effect (Liquid Glass)

Maintain legibility when content scrolls beneath a bar:

```swift
ScrollView {
    LazyVStack {
        ForEach(data) { item in
            RowView(item)
        }
    }
}
.scrollEdgeEffectStyle(.hard, for: .all)
```

### Generated Work Item Card with Badge

```swift
Button {
    openWorkItem(item)
} label: {
    Label(item.title, systemImage: "checkmark.circle")
}
.buttonStyle(.bordered)
.tint(.blue)
.badge(item.commentCount)
```

### Dark Mode Toggle in Chat

```swift
.preferredColorScheme(isDarkMode ? .dark : nil)
```

### Focus Management for Input Field

```swift
enum ChatField: Hashable {
    case messageInput
}

@FocusState private var focusedField: ChatField?

TextField("Message...", text: $text)
    .focused($focusedField, equals: .messageInput)

// Programmatically focus:
focusedField = .messageInput
```

### Context Menu on Message Bubble

```swift
Text(message.content)
    .padding()
    .contextMenu {
        Button {
            copyToClipboard(message.content)
        } label: {
            Label("Copy", systemImage: "doc.on.doc")
        }
        Button(role: .destructive) {
            deleteMessage(message)
        } label: {
            Label("Delete", systemImage: "trash")
        }
    }
```

### Async Task for Streaming Response

```swift
Text(streamedText)
    .task {
        do {
            for try await chunk in responseStream {
                streamedText += chunk
            }
        } catch {
            streamedText = "Failed to load response."
        }
    }
    .contentTransition(.interpolate)
    .animation(.easeInOut, value: streamedText)
```

### Haptic Feedback on Message Send

```swift
Button("Send") { sendMessage() }
    .sensoryFeedback(.selection, trigger: messageCount)
```

## Reference Files

Detailed API documentation lives in `references/`. Read these when you need parameter-level detail or see all available initializers.

| File | Pages | What It Covers |
|---|---|---|
| `scrolling_and_anchoring.md` | 4 | `ScrollView`, `defaultScrollAnchor`, `ScrollViewReader`, `scrollTargetBehavior` — everything for chat scroll position management |
| `message_bubble.md` | 16 | `Text`, `TextField`, `TextEditor`, `RoundedRectangle`, `Capsule`, `foregroundStyle`, `background(_:in:)`, `clipShape`, `shadow`, `font`, `lineLimit`, `padding`, `contextMenu`, `textSelection`, `backgroundExtensionEffect` |
| `message_list_layout.md` | 6 | `VStack`, `HStack`, `ZStack`, `LazyVStack`, `Spacer`, `Divider` — core layout containers for message lists |
| `streaming_and_typing.md` | 11 | `ProgressView`, `phaseAnimator`, `contentTransition`, `transition`, `animation`, `withAnimation`, `TimelineView`, `onChange`, `onReceive`, `task` — animation and streaming patterns |
| `text_input.md` | 5 | `onSubmit`, `FocusState`, `focused`, `submitLabel`, `keyboardShortcut` — text input bar with focus and keyboard handling |
| `inspector_panel.md` | 7 | `NavigationSplitView`, `inspector`, `safeAreaInset`, `safeAreaBar`, `toolbar`, `ToolbarItem`, `navigationTitle` — panel and sidebar layout |
| `liquid_glass.md` | 5 | `glassEffect`, `GlassEffectContainer`, `glassEffectID`, `scrollEdgeEffectStyle`, Adopting Liquid Glass guide — macOS Tahoe / iOS 26 design |
| `avatar_and_identity.md` | 4 | `Circle`, `AsyncImage`, `Image`, `overlay` — avatar rendering with async loading and shape clipping |
| `generated_items.md` | 7 | `Button`, `Label`, `GlassButtonStyle`, `badge`, `tint`, `buttonStyle`, `onTapGesture` — interactive work item cards |
| `color_and_theming.md` | 2 | `Color`, `preferredColorScheme` — dark/light mode and color management |
| `button_and_interaction.md` | 3 | `sensoryFeedback`, `onHover`, `disabled` — interaction polish and feedback |
| `other.md` | 1 | `frame(minWidth:idealWidth:maxWidth:...)` — flexible sizing constraints |

## Working with This Skill

### Getting Started

1. Read this SKILL.md for the patterns and quick reference examples
2. Start with `scrolling_and_anchoring.md` and `message_bubble.md` to build the core chat view
3. Add `text_input.md` patterns for the message input bar
4. Layer in `streaming_and_typing.md` for typing indicators

### Building the Chat Layout

1. Use `inspector_panel.md` or `NavigationSplitView` for sidebar placement
2. Use `message_list_layout.md` for `LazyVStack` inside `ScrollView`
3. Apply `.defaultScrollAnchor(.bottom)` from `scrolling_and_anchoring.md`
4. Style bubbles using patterns from `message_bubble.md`

### Applying Liquid Glass (macOS Tahoe / iOS 26)

1. Read `liquid_glass.md` for `glassEffect` and `GlassEffectContainer`
2. Use `GlassButtonStyle` from `generated_items.md` for action buttons
3. Apply `.scrollEdgeEffectStyle()` for content scrolling under bars
4. Wrap glass effects in `GlassEffectContainer` for performance and morphing

### Adding Polish

- **Haptic feedback**: `sensoryFeedback` from `button_and_interaction.md`
- **Context menus**: `contextMenu` from `message_bubble.md`
- **Keyboard shortcuts**: `keyboardShortcut` from `text_input.md`
- **Hover effects**: `onHover` from `button_and_interaction.md`
- **Text selection**: `textSelection(.enabled)` from `message_bubble.md`

## Architecture Pattern

A typical chat sidebar follows this structure:

```
NavigationSplitView / .inspector()
  +-- ChatView
        +-- ScrollView + .defaultScrollAnchor(.bottom)
        |     +-- LazyVStack
        |           +-- ForEach(messages)
        |                 +-- MessageBubbleView
        |                       +-- HStack (avatar + bubble)
        |                       +-- Text/Markdown content
        |                       +-- .background(in: RoundedRectangle)
        |           +-- TypingIndicatorView (conditional)
        |                 +-- phaseAnimator / ProgressView
        +-- .safeAreaInset(edge: .bottom)
              +-- InputBarView
                    +-- TextField + .onSubmit + @FocusState
                    +-- Button("Send") + .keyboardShortcut
```

## Common Mistakes

| Mistake | Fix |
|---|---|
| Using `VStack` instead of `LazyVStack` for long message lists | Use `LazyVStack` inside `ScrollView` for performance — only renders visible items |
| Forgetting `.defaultScrollAnchor(.bottom)` | Chat lists should start scrolled to the bottom; add this modifier to `ScrollView` |
| Applying `.resizable()` directly to `AsyncImage` | Apply it to the `Image` inside the `content` closure, not the `AsyncImage` itself |
| Overusing Liquid Glass on many custom elements | Apple guidance: limit glass effects to important functional elements; use `GlassEffectContainer` to combine them |
| Hard-coding button layout metrics | Use standard `buttonStyle(.glass)` or `.bordered` — they adapt to platform automatically |
| Using `ScrollViewReader.scrollTo` during content builder execution | Only call `scrollTo` from actions (gesture handlers, `onChange`, etc.), not during view building |
| Not using `submitScope()` on nested text fields | Use `.submitScope()` to prevent inner field submissions from propagating to outer `onSubmit` handlers |
| Using `.animation(_:)` without a `value:` parameter | Prefer `.animation(_:value:)` to scope animations to specific state changes |

## Platform Availability Notes

| Feature | Minimum Platform |
|---|---|
| `glassEffect`, `GlassButtonStyle`, `GlassEffectContainer` | iOS 26.0+, macOS 26.0+ |
| `safeAreaBar`, `scrollEdgeEffectStyle` | iOS 26.0+, macOS 26.0+ |
| `backgroundExtensionEffect` | iOS 26.0+, macOS 26.0+ |
| `inspector(isPresented:)` | iOS 17.0+, macOS 14.0+ |
| `defaultScrollAnchor` | iOS 17.0+, macOS 14.0+ |
| `phaseAnimator` | iOS 17.0+, macOS 14.0+ |
| `scrollTargetBehavior` | iOS 17.0+, macOS 14.0+ |
| `contentTransition` | iOS 16.0+, macOS 13.0+ |
| `NavigationSplitView` | iOS 16.0+, macOS 13.0+ |
| `FocusState` | iOS 15.0+, macOS 12.0+ |
| `AsyncImage` | iOS 15.0+, macOS 12.0+ |
| `task(priority:_:)` | iOS 15.0+, macOS 12.0+ |
| `safeAreaInset` | iOS 15.0+, macOS 12.0+ |
| `ScrollView`, `TextField`, `Text`, `Button` | iOS 13.0+, macOS 10.15+ |

## Notes

- All documentation is extracted from Apple's official SwiftUI docs via sosumi.ai
- Code examples use proper `swift` language annotations
- Reference files preserve original API signatures, conformances, and related links
- Liquid Glass APIs require building against the latest iOS 26 / macOS Tahoe SDK
